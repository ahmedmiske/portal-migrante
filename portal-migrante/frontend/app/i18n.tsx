import React, { createContext, useContext, useEffect, useMemo, useState } from "react";

type Locale = "eu" | "es" | "en" | "ar";
type Dict = Record<string, string>;

type I18nContextType = {
  locale: Locale;
  t: (key: string) => string;
  setLocale: (l: Locale) => void;
  locales: Locale[];
};

const I18nContext = createContext<I18nContextType | null>(null);

const LS_KEY = "portal.locale";
const LOCALES: Locale[] = ["eu", "es", "en", "ar"];
const RTL: Record<Locale, boolean> = { ar: true, es: false, en: false, eu: false };

const dicts: Record<Locale, Dict> = {
  es: {
    app_title: "Portal Migrante Euskadi",
    nav_home: "Inicio",
    nav_services: "Servicios",
    nav_ads: "Anuncios",
    nav_observatory: "Observatorio",
    nav_about: "Acerca",
    nav_contact: "Contacto",
    back: "← Volver",
    save: "Guardar",
    search: "Buscar",
    no_data: "No hay datos.",
    loading: "Cargando…",
    welcome_title: "Bienvenido",
    welcome_body: "Tu puerta de entrada a servicios y recursos en Euskadi.",
    cta_services: "Categorías de servicios",
    f_health: "Salud",
    f_housing: "Vivienda",
    f_education: "Educación",
    f_legal: "Legal",
    f_work: "Empleo",
    f_language: "Idioma",
    users_title: "Usuarios",
    users_new: "Añadir usuario",
    // Home page news and stats
    home_news_title: "Últimas Noticias y Actualizaciones",
    home_view_all: "Ver todas",
    news_1_title: "Nuevas ayudas para vivienda en 2024",
    news_1_summary: "El Gobierno Vasco anuncia nuevas subvenciones para el alquiler dirigidas a personas migrantes.",
    news_1_date: "25 Sep 2024",
    news_2_title: "Programa de integración laboral ampliado",
    news_2_summary: "Se amplían los cursos de formación profesional con traducción a múltiples idiomas.",
    news_2_date: "22 Sep 2024",
    news_3_title: "Nueva oficina de atención en Donostia",
    news_3_summary: "Apertura de un nuevo centro de información y trámites específico para migrantes.",
    news_3_date: "20 Sep 2024",
    news_housing: "Vivienda",
    news_employment: "Empleo",
    news_services: "Servicios",
    home_stats_title: "Impacto del Portal Migrante",
    stats_users: "Usuarios registrados",
    stats_services: "Servicios consultados",
    stats_countries: "Países de origen",
    stats_satisfaction: "Satisfacción de usuarios",
    home_view_observatory: "Ver más estadísticas en el Observatorio",
    name: "Nombre",
    email: "Email",
    phone: "Teléfono",
    city: "Ciudad",
    footer_madeby: "Hecho con ❤️ para la comunidad migrante.",
    footer_about: "Acerca del portal",
    footer_contact: "Contacto",
    footer_privacy: "Privacidad",
    footer_terms: "Términos",
    footer_newsletter: "Boletín",
    footer_email_placeholder: "tu@email.com",
    footer_subscribe: "Suscribirse",
    footer_rights: "Todos los derechos reservados",
    quick_links: "Accesos rápidos",
    cta_ads: "Anuncios",
    // Contact page
    contact_title: "Contacta con Nosotros",
    contact_subtitle: "Estamos aquí para ayudarte. No dudes en ponerte en contacto con nuestro equipo.",
    // Observatory page
    observatory_title: "Observatorio de Migración de Euskadi",
    observatory_description: "El Observatorio de Migración de Euskadi es un centro de investigación y análisis que proporciona datos actualizados, estudios y tendencias sobre los procesos migratorios en el País Vasco.",
    observatory_stats_title: "Estadísticas y Análisis",
    observatory_migration_stats: "Datos Migratorios",
    observatory_migration_desc: "Estadísticas actualizadas sobre flujos migratorios",
    observatory_integration_stats: "Indicadores de Integración",
    observatory_integration_desc: "Métricas de integración social y laboral",
    observatory_research_stats: "Investigación",
    observatory_research_desc: "Estudios y análisis especializados",
    observatory_recent_reports: "Informes Recientes",
    observatory_report_1_title: "Informe Anual de Migración 2024",
    observatory_report_1_date: "Septiembre 2024",
    observatory_report_2_title: "Integración Laboral de Migrantes",
    observatory_report_2_date: "Agosto 2024",
    observatory_report_3_title: "Tendencias Migratorias Post-COVID",
    observatory_report_3_date: "Julio 2024",
    observatory_view_all_reports: "Ver Todos los Informes",
    observatory_resources: "Recursos",
    observatory_resource_1: "Metodología de Investigación",
    observatory_resource_2: "Indicadores Estadísticos",
    observatory_resource_3: "Estudios Comparativos",
    observatory_resource_4: "Base de Datos Migratoria",
    contact_info: "Información de Contacto",
    address: "Dirección",
    office_hours: "Horario de Atención",
    monday_friday: "Lunes - Viernes",
    weekend: "Fin de semana",
    closed: "Cerrado",
    find_us: "Encuéntranos",
    map_placeholder: "Mapa interactivo (próximamente)",
    send_message: "Enviar Mensaje",
    full_name: "Nombre Completo",
    enter_name: "Ingresa tu nombre",
    enter_email: "Ingresa tu email",
    enter_phone: "Ingresa tu teléfono",
    subject: "Asunto",
    select_subject: "Selecciona un asunto",
    services_inquiry: "Consulta sobre servicios",
    technical_support: "Soporte técnico",
    general_inquiry: "Consulta general",
    feedback: "Comentarios y sugerencias",
    message: "Mensaje",
    enter_message: "Escribe tu mensaje aquí...",
    send_message_btn: "Enviar Mensaje",
    contact_success_title: "¡Mensaje Enviado!",
    contact_success_message: "Gracias por contactarnos. Nos pondremos en contacto contigo pronto.",
    send_another_message: "Enviar otro mensaje",
    // About page
    about_title: "Acerca del Portal Migrante Euskadi",
    about_subtitle: "Construyendo puentes hacia la integración y el bienestar de la comunidad migrante en Euskadi",
    our_mission: "Nuestra Misión",
    mission_description: "El Portal Migrante Euskadi nace con el objetivo de facilitar la integración de las personas migrantes en el País Vasco, proporcionando información, recursos y servicios accesibles en múltiples idiomas.",
    mission_commitment: "Nuestro compromiso es crear un espacio inclusivo donde cada persona pueda encontrar las herramientas necesarias para construir una nueva vida en Euskadi, manteniendo su identidad cultural y contribuyendo al enriquecimiento de nuestra sociedad.",
    our_values: "Nuestros Valores",
    value_inclusion: "Inclusión y diversidad",
    value_solidarity: "Solidaridad y apoyo mutuo",
    value_diversity: "Respeto a la diversidad cultural",
    value_empowerment: "Empoderamiento comunitario",
    our_impact: "Nuestro Impacto",
    stat_users: "Usuarios registrados",
    stat_services: "Servicios disponibles",
    stat_languages: "Idiomas soportados",
    stat_years: "Años de servicio",
    our_history: "Nuestra Historia",
    history_2021_title: "Fundación del Portal",
    history_2021_description: "Inicio del proyecto con el apoyo del Gobierno Vasco y organizaciones de la sociedad civil para crear un recurso integral para migrantes.",
    history_2022_title: "Expansión de Servicios",
    history_2022_description: "Ampliación de la plataforma con nuevos servicios de salud, educación y empleo, alcanzando miles de usuarios.",
    history_2025_title: "Portal Digital Renovado",
    history_2025_description: "Lanzamiento de la nueva plataforma digital con interfaz multiidioma y servicios digitales avanzados.",
    our_team: "Nuestro Equipo",
    team_director: "Directora General",
    team_coordinator: "Coordinador de Servicios",
    team_social_worker: "Trabajadora Social",
    team_translator: "Traductor e Intérprete",
    ana_description: "Especialista en políticas de migración con más de 15 años de experiencia.",
    mohamed_description: "Coordinador bilingüe especializado en atención a refugiados y solicitantes de asilo.",
    elena_description: "Trabajadora social especializada en intervención familiar y comunitaria.",
    amir_description: "Traductor certificado en árabe, francés y español con experiencia en mediación intercultural.",
    our_partners: "Nuestros Socios",
    government_euskadi: "Gobierno Vasco",
    civil_organizations: "Organizaciones Civiles",
    international_orgs: "Organizaciones Internacionales",
    partner_government_description: "Colaboración estrecha con las instituciones vascas para garantizar servicios públicos accesibles.",
    partner_civil_description: "Red de ONG y asociaciones locales que trabajan directamente con comunidades migrantes.",
    partner_international_description: "Cooperación con ACNUR, OIM y otras organizaciones internacionales.",
    join_us_title: "Únete a Nuestra Misión",
    join_us_description: "Juntos podemos construir una sociedad más inclusiva y solidaria. Tu participación es fundamental.",
    contact_us: "Contáctanos",
    explore_services: "Explorar Servicios",
    // Ads page
    ads_title: "Anuncios Comunitarios",
    ads_subtitle: "Encuentra y publica anuncios útiles para la comunidad migrante en Euskadi",
    filter_ads: "Filtrar Anuncios",
    category: "Categoría",
    location: "Ubicación",
    urgent_only: "Solo urgentes",
    add_ad: "Publicar Anuncio",
    showing_results: "Mostrando",
    of: "de",
    ads: "anuncios",
    all_categories: "Todas las categorías",
    all_locations: "Todas las ubicaciones",
    community: "Comunidad",
    search_placeholder: "Buscar anuncios...",
    urgent: "Urgente",
    verified: "Verificado",
    price: "Precio",
    date: "Fecha",
    contact: "Contactar",
    no_ads_found: "No se encontraron anuncios",
    try_different_filters: "Intenta con filtros diferentes",
    clear_filters: "Limpiar filtros",
    share_your_ad: "Comparte tu Anuncio",
    help_community_description: "Ayuda a la comunidad compartiendo información útil, servicios u oportunidades",
    publish_ad: "Publicar Anuncio",
    need_help: "¿Necesitas ayuda?",
    negotiable: "Negociable",
    free_consultation: "Consulta gratuita",
    free: "Gratis",
    // Sample ads
    ad_housing_vitoria: "Habitación disponible en Vitoria",
    ad_housing_vitoria_desc: "Habitación amueblada en piso compartido, zona centro, transporte público cerca.",
    ad_job_bilbao: "Trabajo de camarero en Bilbao",
    ad_job_bilbao_desc: "Restaurante busca camarero con experiencia, horario flexible, buen ambiente laboral.",
    ad_spanish_classes: "Clases de español personalizadas",
    ad_spanish_classes_desc: "Profesora nativa ofrece clases de español para inmigrantes, todos los niveles.",
    ad_legal_services: "Asesoría legal para inmigrantes",
    ad_legal_services_desc: "Abogado especializado en derecho de extranjería, primera consulta gratuita.",
    ad_medical_interpreter: "Intérprete médico árabe-español",
    ad_medical_interpreter_desc: "Servicio de interpretación para citas médicas y trámites sanitarios.",
    ad_community_event: "Evento intercultural comunitario",
    ad_community_event_desc: "Celebración multicultural con comida, música y actividades para toda la familia.",
  },

  en: {
    app_title: "Migrant Portal Euskadi",
    nav_home: "Home",
    nav_services: "Services",
    nav_ads: "Ads",
    nav_observatory: "Observatory",
    nav_about: "About",
    nav_contact: "Contact",
    back: "← Back",
    save: "Save",
    search: "Search",
    no_data: "No data.",
    loading: "Loading…",
    welcome_title: "Welcome",
    welcome_body: "Your gateway to services and resources in the Basque Country.",
    cta_services: "Service categories",
    f_health: "Health",
    f_housing: "Housing",
    f_education: "Education",
    f_legal: "Legal",
    f_work: "Work",
    f_language: "Language",
    users_title: "Users",
    users_new: "New user",
    // Home page news and stats
    home_news_title: "Latest News and Updates",
    home_view_all: "View all",
    news_1_title: "New housing assistance in 2024",
    news_1_summary: "The Basque Government announces new rental subsidies aimed at migrants.",
    news_1_date: "Sep 25, 2024",
    news_2_title: "Expanded job integration program",
    news_2_summary: "Professional training courses are expanded with translation into multiple languages.",
    news_2_date: "Sep 22, 2024",
    news_3_title: "New service office in Donostia",
    news_3_summary: "Opening of a new information and procedures center specific for migrants.",
    news_3_date: "Sep 20, 2024",
    news_housing: "Housing",
    news_employment: "Employment",
    news_services: "Services",
    home_stats_title: "Migrant Portal Impact",
    stats_users: "Registered users",
    stats_services: "Services consulted",
    stats_countries: "Countries of origin",
    stats_satisfaction: "User satisfaction",
    home_view_observatory: "View more statistics in the Observatory",
    name: "Name",
    email: "Email",
    phone: "Phone",
    city: "City",
    footer_madeby: "Made with ❤️ for the migrant community.",
    footer_about: "About the portal",
    footer_contact: "Contact",
    footer_privacy: "Privacy",
    footer_terms: "Terms",
    footer_newsletter: "Newsletter",
    footer_email_placeholder: "you@email.com",
    footer_subscribe: "Subscribe",
    footer_rights: "All rights reserved",
    quick_links: "Quick links",
    cta_ads: "Ads",
    // Contact page
    contact_title: "Contact Us",
    contact_subtitle: "We're here to help you. Don't hesitate to get in touch with our team.",
    // Observatory page
    observatory_title: "Euskadi Migration Observatory",
    observatory_description: "The Euskadi Migration Observatory is a research and analysis center that provides updated data, studies and trends on migration processes in the Basque Country.",
    observatory_stats_title: "Statistics and Analysis",
    observatory_migration_stats: "Migration Data",
    observatory_migration_desc: "Updated statistics on migration flows",
    observatory_integration_stats: "Integration Indicators",
    observatory_integration_desc: "Social and labor integration metrics",
    observatory_research_stats: "Research",
    observatory_research_desc: "Specialized studies and analysis",
    observatory_recent_reports: "Recent Reports",
    observatory_report_1_title: "Annual Migration Report 2024",
    observatory_report_1_date: "September 2024",
    observatory_report_2_title: "Labor Integration of Migrants",
    observatory_report_2_date: "August 2024",
    observatory_report_3_title: "Post-COVID Migration Trends",
    observatory_report_3_date: "July 2024",
    observatory_view_all_reports: "View All Reports",
    observatory_resources: "Resources",
    observatory_resource_1: "Research Methodology",
    observatory_resource_2: "Statistical Indicators",
    observatory_resource_3: "Comparative Studies",
    observatory_resource_4: "Migration Database",
    contact_info: "Contact Information",
    address: "Address",
    office_hours: "Office Hours",
    monday_friday: "Monday - Friday",
    weekend: "Weekend",
    closed: "Closed",
    find_us: "Find Us",
    map_placeholder: "Interactive map (coming soon)",
    send_message: "Send Message",
    full_name: "Full Name",
    enter_name: "Enter your name",
    enter_email: "Enter your email",
    enter_phone: "Enter your phone",
    subject: "Subject",
    select_subject: "Select a subject",
    services_inquiry: "Services inquiry",
    technical_support: "Technical support",
    general_inquiry: "General inquiry",
    feedback: "Feedback and suggestions",
    message: "Message",
    enter_message: "Write your message here...",
    send_message_btn: "Send Message",
    contact_success_title: "Message Sent!",
    contact_success_message: "Thank you for contacting us. We'll get back to you soon.",
    send_another_message: "Send another message",
    // About page
    about_title: "About Portal Migrante Euskadi",
    about_subtitle: "Building bridges towards integration and wellbeing of the migrant community in Euskadi",
    our_mission: "Our Mission",
    mission_description: "Portal Migrante Euskadi was created with the goal of facilitating the integration of migrants in the Basque Country, providing accessible information, resources and services in multiple languages.",
    mission_commitment: "Our commitment is to create an inclusive space where every person can find the necessary tools to build a new life in Euskadi, maintaining their cultural identity and contributing to the enrichment of our society.",
    our_values: "Our Values",
    value_inclusion: "Inclusion and diversity",
    value_solidarity: "Solidarity and mutual support",
    value_diversity: "Respect for cultural diversity",
    value_empowerment: "Community empowerment",
    our_impact: "Our Impact",
    stat_users: "Registered users",
    stat_services: "Available services",
    stat_languages: "Supported languages",
    stat_years: "Years of service",
    our_history: "Our History",
    history_2021_title: "Portal Foundation",
    history_2021_description: "Project launch with support from the Basque Government and civil society organizations to create a comprehensive resource for migrants.",
    history_2022_title: "Service Expansion",
    history_2022_description: "Platform expansion with new health, education and employment services, reaching thousands of users.",
    history_2025_title: "Renewed Digital Portal",
    history_2025_description: "Launch of the new digital platform with multilingual interface and advanced digital services.",
    our_team: "Our Team",
    team_director: "General Director",
    team_coordinator: "Services Coordinator",
    team_social_worker: "Social Worker",
    team_translator: "Translator and Interpreter",
    ana_description: "Migration policy specialist with over 15 years of experience.",
    mohamed_description: "Bilingual coordinator specialized in refugee and asylum seeker care.",
    elena_description: "Social worker specialized in family and community intervention.",
    amir_description: "Certified translator in Arabic, French and Spanish with experience in intercultural mediation.",
    our_partners: "Our Partners",
    government_euskadi: "Basque Government",
    civil_organizations: "Civil Organizations",
    international_orgs: "International Organizations",
    partner_government_description: "Close collaboration with Basque institutions to ensure accessible public services.",
    partner_civil_description: "Network of NGOs and local associations working directly with migrant communities.",
    partner_international_description: "Cooperation with UNHCR, IOM and other international organizations.",
    join_us_title: "Join Our Mission",
    join_us_description: "Together we can build a more inclusive and supportive society. Your participation is fundamental.",
    contact_us: "Contact Us",
    explore_services: "Explore Services",
    // Ads page
    ads_title: "Community Announcements",
    ads_subtitle: "Find and post useful announcements for the migrant community in Euskadi",
    filter_ads: "Filter Announcements",
    category: "Category",
    location: "Location",
    urgent_only: "Urgent only",
    add_ad: "Post Ad",
    showing_results: "Showing",
    of: "of",
    ads: "ads",
    all_categories: "All categories",
    all_locations: "All locations",
    community: "Community",
    search_placeholder: "Search ads...",
    urgent: "Urgent",
    verified: "Verified",
    price: "Price",
    date: "Date",
    contact: "Contact",
    no_ads_found: "No ads found",
    try_different_filters: "Try different filters",
    clear_filters: "Clear filters",
    share_your_ad: "Share Your Ad",
    help_community_description: "Help the community by sharing useful information, services or opportunities",
    publish_ad: "Publish Ad",
    need_help: "Need help?",
    negotiable: "Negotiable",
    free_consultation: "Free consultation",
    free: "Free",
    // Sample ads
    ad_housing_vitoria: "Room available in Vitoria",
    ad_housing_vitoria_desc: "Furnished room in shared apartment, city center, public transport nearby.",
    ad_job_bilbao: "Waiter job in Bilbao",
    ad_job_bilbao_desc: "Restaurant looking for experienced waiter, flexible hours, good work environment.",
    ad_spanish_classes: "Personalized Spanish classes",
    ad_spanish_classes_desc: "Native teacher offers Spanish classes for immigrants, all levels.",
    ad_legal_services: "Legal advice for immigrants",
    ad_legal_services_desc: "Lawyer specialized in immigration law, first consultation free.",
    ad_medical_interpreter: "Arabic-Spanish medical interpreter",
    ad_medical_interpreter_desc: "Interpretation service for medical appointments and health procedures.",
    ad_community_event: "Intercultural community event",
    ad_community_event_desc: "Multicultural celebration with food, music and activities for the whole family.",
  },

  ar: {
    app_title: "بوابة المهاجر في الباسك",
    nav_home: "الرئيسية",
    nav_services: "الخدمات",
    nav_ads: "الإعلانات",
    nav_observatory: "المرصد",
    nav_about: "عن البوابة",
    nav_contact: "تواصل",
    back: "← رجوع",
    save: "حفظ",
    search: "بحث",
    no_data: "لا توجد بيانات.",
    loading: "جاري التحميل…",
    welcome_title: "مرحبًا بك",
    welcome_body: "بوابتك إلى الخدمات والموارد في إقليم الباسك.",
    cta_services: "تصنيفات الخدمات",
    f_health: "الصحة",
    f_housing: "السكن",
    f_education: "التعليم",
    f_legal: "القانوني",
    f_work: "العمل",
    f_language: "اللغة",
    users_title: "المستخدمون",
    users_new: "إضافة مستخدم",
    // Home page news and stats
    home_news_title: "آخر الأخبار والتحديثات",
    home_view_all: "عرض الكل",
    news_1_title: "مساعدات جديدة للسكن في 2024",
    news_1_summary: "حكومة الباسك تعلن عن إعانات إيجار جديدة موجهة للمهاجرين.",
    news_1_date: "25 سبتمبر 2024",
    news_2_title: "توسيع برنامج الاندماج المهني",
    news_2_summary: "توسيع دورات التدريب المهني مع الترجمة إلى لغات متعددة.",
    news_2_date: "22 سبتمبر 2024",
    news_3_title: "مكتب خدمات جديد في دونوستيا",
    news_3_summary: "افتتاح مركز جديد للمعلومات والإجراءات مخصص للمهاجرين.",
    news_3_date: "20 سبتمبر 2024",
    news_housing: "السكن",
    news_employment: "التوظيف",
    news_services: "الخدمات",
    home_stats_title: "تأثير بوابة المهاجر",
    stats_users: "المستخدمون المسجلون",
    stats_services: "الخدمات المستشارة",
    stats_countries: "البلدان الأصلية",
    stats_satisfaction: "رضا المستخدمين",
    home_view_observatory: "عرض المزيد من الإحصائيات في المرصد",
    name: "الاسم",
    email: "الإيميل",
    phone: "الهاتف",
    city: "المدينة",
    footer_madeby: "صنع بحب ❤️ لخدمة مجتمع المهاجرين.",
    footer_about: "عن البوابة",
    footer_contact: "تواصل",
    footer_privacy: "الخصوصية",
    footer_terms: "الشروط",
    footer_newsletter: "النشرة البريدية",
    footer_email_placeholder: "you@email.com",
    footer_subscribe: "اشترك",
    footer_rights: "جميع الحقوق محفوظة",
    quick_links: "روابط سريعة",
    cta_ads: "الإعلانات",
    // Contact page
    contact_title: "تواصل معنا",
    contact_subtitle: "نحن هنا لمساعدتك. لا تتردد في التواصل مع فريقنا.",
    // Observatory page
    observatory_title: "مرصد الهجرة في إقليم الباسك",
    observatory_description: "مرصد الهجرة في إقليم الباسك هو مركز للبحث والتحليل يوفر بيانات محدثة ودراسات واتجاهات حول عمليات الهجرة في بلاد الباسك.",
    observatory_stats_title: "الإحصائيات والتحليل",
    observatory_migration_stats: "بيانات الهجرة",
    observatory_migration_desc: "إحصائيات محدثة حول تدفقات الهجرة",
    observatory_integration_stats: "مؤشرات الاندماج",
    observatory_integration_desc: "مقاييس الاندماج الاجتماعي والمهني",
    observatory_research_stats: "البحوث",
    observatory_research_desc: "دراسات وتحليلات متخصصة",
    observatory_recent_reports: "التقارير الحديثة",
    observatory_report_1_title: "التقرير السنوي للهجرة 2024",
    observatory_report_1_date: "سبتمبر 2024",
    observatory_report_2_title: "الاندماج المهني للمهاجرين",
    observatory_report_2_date: "أغسطس 2024",
    observatory_report_3_title: "اتجاهات الهجرة ما بعد كوفيد",
    observatory_report_3_date: "يوليو 2024",
    observatory_view_all_reports: "عرض جميع التقارير",
    observatory_resources: "الموارد",
    observatory_resource_1: "منهجية البحث",
    observatory_resource_2: "المؤشرات الإحصائية",
    observatory_resource_3: "الدراسات المقارنة",
    observatory_resource_4: "قاعدة بيانات الهجرة",
    contact_info: "معلومات الاتصال",
    address: "العنوان",
    office_hours: "ساعات الدوام",
    monday_friday: "الاثنين - الجمعة",
    weekend: "عطلة نهاية الأسبوع",
    closed: "مغلق",
    find_us: "تجدنا هنا",
    map_placeholder: "خريطة تفاعلية (قريباً)",
    send_message: "إرسال رسالة",
    full_name: "الاسم الكامل",
    enter_name: "أدخل اسمك",
    enter_email: "أدخل بريدك الإلكتروني",
    enter_phone: "أدخل رقم الهاتف",
    subject: "الموضوع",
    select_subject: "اختر الموضوع",
    services_inquiry: "استفسار عن الخدمات",
    technical_support: "الدعم التقني",
    general_inquiry: "استفسار عام",
    feedback: "تعليقات واقتراحات",
    message: "الرسالة",
    enter_message: "اكتب رسالتك هنا...",
    send_message_btn: "إرسال الرسالة",
    contact_success_title: "تم إرسال الرسالة!",
    contact_success_message: "شكراً لتواصلك معنا. سنعود إليك قريباً.",
    send_another_message: "إرسال رسالة أخرى",
    // About page
    about_title: "حول بوابة المهاجر في الباسك",
    about_subtitle: "بناء جسور نحو الاندماج ورفاهية المجتمع المهاجر في الباسك",
    our_mission: "مهمتنا",
    mission_description: "وُلدت بوابة المهاجر في الباسك بهدف تسهيل اندماج المهاجرين في إقليم الباسك، من خلال توفير المعلومات والموارد والخدمات المتاحة بلغات متعددة.",
    mission_commitment: "التزامنا هو إنشاء مساحة شاملة حيث يمكن لكل شخص العثور على الأدوات اللازمة لبناء حياة جديدة في الباسك، مع الحفاظ على هويته الثقافية والمساهمة في إثراء مجتمعنا.",
    our_values: "قيمنا",
    value_inclusion: "الشمولية والتنوع",
    value_solidarity: "التضامن والدعم المتبادل",
    value_diversity: "احترام التنوع الثقافي",
    value_empowerment: "تمكين المجتمع",
    our_impact: "تأثيرنا",
    stat_users: "المستخدمون المسجلون",
    stat_services: "الخدمات المتاحة",
    stat_languages: "اللغات المدعومة",
    stat_years: "سنوات الخدمة",
    our_history: "تاريخنا",
    history_2021_title: "تأسيس البوابة",
    history_2021_description: "بداية المشروع بدعم من حكومة الباسك ومنظمات المجتمع المدني لإنشاء مورد شامل للمهاجرين.",
    history_2022_title: "توسيع الخدمات",
    history_2022_description: "توسيع المنصة بخدمات جديدة في الصحة والتعليم والعمل، ووصولها لآلاف المستخدمين.",
    history_2025_title: "البوابة الرقمية المجددة",
    history_2025_description: "إطلاق المنصة الرقمية الجديدة بواجهة متعددة اللغات وخدمات رقمية متقدمة.",
    our_team: "فريقنا",
    team_director: "المديرة العامة",
    team_coordinator: "منسق الخدمات",
    team_social_worker: "أخصائية اجتماعية",
    team_translator: "مترجم ومترجم فوري",
    ana_description: "متخصصة في سياسات الهجرة مع أكثر من 15 عاماً من الخبرة.",
    mohamed_description: "منسق ثنائي اللغة متخصص في رعاية اللاجئين وطالبي اللجوء.",
    elena_description: "أخصائية اجتماعية متخصصة في التدخل الأسري والمجتمعي.",
    amir_description: "مترجم معتمد في العربية والفرنسية والإسبانية مع خبرة في الوساطة الثقافية.",
    our_partners: "شركاؤنا",
    government_euskadi: "حكومة الباسك",
    civil_organizations: "المنظمات المدنية",
    international_orgs: "المنظمات الدولية",
    partner_government_description: "تعاون وثيق مع المؤسسات الباسكية لضمان الخدمات العامة المتاحة.",
    partner_civil_description: "شبكة من المنظمات غير الحكومية والجمعيات المحلية التي تعمل مباشرة مع المجتمعات المهاجرة.",
    partner_international_description: "التعاون مع المفوضية السامية للأمم المتحدة لشؤون اللاجئين والمنظمة الدولية للهجرة ومنظمات دولية أخرى.",
    join_us_title: "انضم إلى مهمتنا",
    join_us_description: "معاً يمكننا بناء مجتمع أكثر شمولية وتضامناً. مشاركتك أساسية.",
    contact_us: "تواصل معنا",
    explore_services: "استكشف الخدمات",
    // Ads page
    ads_title: "الإعلانات المجتمعية",
    ads_subtitle: "ابحث وانشر إعلانات مفيدة للمجتمع المهاجر في الباسك",
    filter_ads: "تصفية الإعلانات",
    category: "الفئة",
    location: "الموقع",
    urgent_only: "العاجل فقط",
    add_ad: "نشر إعلان",
    showing_results: "عرض",
    of: "من",
    ads: "إعلانات",
    all_categories: "جميع الفئات",
    all_locations: "جميع المواقع",
    community: "المجتمع",
    search_placeholder: "البحث في الإعلانات...",
    urgent: "عاجل",
    verified: "موثق",
    price: "السعر",
    date: "التاريخ",
    contact: "تواصل",
    no_ads_found: "لم يتم العثور على إعلانات",
    try_different_filters: "جرب مرشحات مختلفة",
    clear_filters: "مسح المرشحات",
    share_your_ad: "شارك إعلانك",
    help_community_description: "ساعد المجتمع من خلال مشاركة المعلومات المفيدة أو الخدمات أو الفرص",
    publish_ad: "نشر إعلان",
    need_help: "تحتاج مساعدة؟",
    negotiable: "قابل للتفاوض",
    free_consultation: "استشارة مجانية",
    free: "مجاني",
    // Sample ads
    ad_housing_vitoria: "غرفة متاحة في فيتوريا",
    ad_housing_vitoria_desc: "غرفة مفروشة في شقة مشتركة، وسط المدينة، وسائل نقل عامة قريبة.",
    ad_job_bilbao: "وظيفة نادل في بلباو",
    ad_job_bilbao_desc: "مطعم يبحث عن نادل ذو خبرة، ساعات مرنة، بيئة عمل جيدة.",
    ad_spanish_classes: "دروس إسبانية شخصية",
    ad_spanish_classes_desc: "معلمة أصلية تقدم دروس إسبانية للمهاجرين، جميع المستويات.",
    ad_legal_services: "استشارة قانونية للمهاجرين",
    ad_legal_services_desc: "محامي متخصص في قانون الأجانب، الاستشارة الأولى مجانية.",
    ad_medical_interpreter: "مترجم طبي عربي-إسباني",
    ad_medical_interpreter_desc: "خدمة ترجمة للمواعيد الطبية والإجراءات الصحية.",
    ad_community_event: "فعالية مجتمعية متعددة الثقافات",
    ad_community_event_desc: "احتفال متعدد الثقافات مع الطعام والموسيقى والأنشطة لجميع أفراد الأسرة.",
  },

  eu: {
    app_title: "Migratzaileen Ataria Euskadin",
    nav_home: "Hasiera",
    nav_services: "Zerbitzuak",
    nav_ads: "Iragarkiak",
    nav_observatory: "Behatokia",
    nav_about: "Honi buruz",
    nav_contact: "Harremana",
    back: "← Itzuli",
    save: "Gorde",
    search: "Bilatu",
    no_data: "Ez dago daturik.",
    loading: "Kargatzen…",
    welcome_title: "Ongi etorri",
    welcome_body: "Zure ataria Euskal Herriko zerbitzu eta baliabideetara.",
    cta_services: "Zerbitzu kategoriak",
    f_health: "Osasuna",
    f_housing: "Etxebizitza",
    f_education: "Hezkuntza",
    f_legal: "Legezkoa",
    f_work: "Lana",
    f_language: "Hizkuntza",
    users_title: "Erabiltzaileak",
    users_new: "Erabiltzaile berria",
    // Home page news and stats
    home_news_title: "Azken Berriak eta Eguneraketak",
    home_view_all: "Denak ikusi",
    news_1_title: "2024ko etxebizitzarako laguntza berriak",
    news_1_summary: "Eusko Jaurlaritzak migratzaileei zuzendutako alokairuko diru-laguntza berriak iragarri ditu.",
    news_1_date: "2024ko Iraila 25",
    news_2_title: "Lan integrazioaren programa zabaldu da",
    news_2_summary: "Lanbide prestakuntza ikastaroak zabaltzen dira hizkuntza anitzetan itzulpenarekin.",
    news_2_date: "2024ko Iraila 22",
    news_3_title: "Donostiako arreta bulego berria",
    news_3_summary: "Migratzaileentzako espezifikoa den informazio eta izapide zentro berri bat ireki da.",
    news_3_date: "2024ko Iraila 20",
    news_housing: "Etxebizitza",
    news_employment: "Enplegua",
    news_services: "Zerbitzuak",
    home_stats_title: "Migratzaileen Atariaren Eragina",
    stats_users: "Erregistratutako erabiltzaileak",
    stats_services: "Kontsultatutako zerbitzuak",
    stats_countries: "Jatorrizko herriak",
    stats_satisfaction: "Erabiltzaileen gogobetetasuna",
    home_view_observatory: "Ikusi estatistika gehiago Behatokian",
    name: "Izena",
    email: "Emaila",
    phone: "Telefonoa",
    city: "Hiria",
    footer_madeby: "❤️rekin egina migratzaileen komunitatearentzat.",
    footer_about: "Atariaren inguruan",
    footer_contact: "Harremana",
    footer_privacy: "Pribatutasuna",
    footer_terms: "Baldintzak",
    footer_newsletter: "Aldizkaria",
    footer_email_placeholder: "zure@emaila.com",
    footer_subscribe: "Harpidetu",
    footer_rights: "Eskubide guztiak gordeak",
    quick_links: "Esteka azkarrak",
    cta_ads: "Iragarkiak",
    // Contact page
    contact_title: "Jarri Gurekin Harremanetan",
    contact_subtitle: "Hemen gaude laguntzeko. Ez izan zalantzarik gure taldearekin harremanetan jartzeko.",
    // Observatory page
    observatory_title: "Euskadiko Migrazio Behatokia",
    observatory_description: "Euskadiko Migrazio Behatokia ikerketa eta analisi zentro bat da, Euskal Herrian migrazio prozesuei buruzko datu eguneratuak, ikerketak eta joerak eskaintzen dituena.",
    observatory_stats_title: "Estatistikak eta Analisia",
    observatory_migration_stats: "Migrazio Datuak",
    observatory_migration_desc: "Migrazio fluxuei buruzko estatistika eguneratuak",
    observatory_integration_stats: "Integrazio Adierazleak",
    observatory_integration_desc: "Gizarte eta lan integrazioaren metrikak",
    observatory_research_stats: "Ikerketa",
    observatory_research_desc: "Ikerketa eta analisi espezializatuak",
    observatory_recent_reports: "Azken Txostenak",
    observatory_report_1_title: "2024ko Migrazio Txosten Urtekoa",
    observatory_report_1_date: "2024ko Iraila",
    observatory_report_2_title: "Migratzaileen Lan Integrazioa",
    observatory_report_2_date: "2024ko Abuztua",
    observatory_report_3_title: "COVID ondorengo Migrazio Joerak",
    observatory_report_3_date: "2024ko Uztaila",
    observatory_view_all_reports: "Txosten Guztiak Ikusi",
    observatory_resources: "Baliabideak",
    observatory_resource_1: "Ikerketa Metodologia",
    observatory_resource_2: "Estatistika Adierazleak",
    observatory_resource_3: "Ikerketa Konparatiboak",
    observatory_resource_4: "Migrazio Datu-basea",
    contact_info: "Harremanen Informazioa",
    address: "Helbidea",
    office_hours: "Arreta Orduak",
    monday_friday: "Astelehena - Ostirala",
    weekend: "Asteburua",
    closed: "Itxita",
    find_us: "Aurkitu Gaitzazu",
    map_placeholder: "Mapa interaktiboa (laster)",
    send_message: "Mezua Bidali",
    full_name: "Izen Osoa",
    enter_name: "Sartu zure izena",
    enter_email: "Sartu zure emaila",
    enter_phone: "Sartu zure telefonoa",
    subject: "Gaia",
    select_subject: "Hautatu gai bat",
    services_inquiry: "Zerbitzuen galdeketa",
    technical_support: "Laguntza teknikoa",
    general_inquiry: "Galdera orokorra",
    feedback: "Iruzkinak eta proposamenak",
    message: "Mezua",
    enter_message: "Idatzi zure mezua hemen...",
    send_message_btn: "Mezua Bidali",
    contact_success_title: "Mezua Bidalia!",
    contact_success_message: "Eskerrik asko gurekin harremanetan jartzeagatik. Laster erantzungo dizugu.",
    send_another_message: "Beste mezu bat bidali",
    // About page
    about_title: "Migratzaileen Ataria Euskadiri Buruz",
    about_subtitle: "Euskadiko migratzaileen komunitatearen integraziorako eta ongizaterako zubiak eraikitzen",
    our_mission: "Gure Misioa",
    mission_description: "Migratzaileen Ataria Euskadin sortu zen Euskal Herrian migratzaileen integrazioa errazteko helburuarekin, hizkuntza anitzetan informazioa, baliabideak eta zerbitzuak eskainiz.",
    mission_commitment: "Gure konpromisoa pertsona bakoitzak Euskadin bizitza berri bat eraikitzeko beharrezko tresnak aurkitu ditzan espazio inklusibo bat sortzea da, bere identitate kulturala mantenduz eta gure gizartearen aberastasunean lagunduz.",
    our_values: "Gure Balioak",
    value_inclusion: "Inklusioa eta aniztasuna",
    value_solidarity: "Elkartasuna eta elkarrekiko laguntza",
    value_diversity: "Kultura aniztasunaren errespetua",
    value_empowerment: "Komunitatearen ahalduntzea",
    our_impact: "Gure Eragina",
    stat_users: "Izena emandako erabiltzaileak",
    stat_services: "Zerbitzu eskuragarriak",
    stat_languages: "Onartutako hizkuntzak",
    stat_years: "Zerbitzuaren urteak",
    our_history: "Gure Historia",
    history_2021_title: "Atariaren Sorrera",
    history_2021_description: "Proiektuaren hasiera Eusko Jaurlaritzaren eta gizarte zibileko erakundeen laguntzarekin migratzaileentzako baliabide integral bat sortzeko.",
    history_2022_title: "Zerbitzuen Hedapena",
    history_2022_description: "Plataformaren hedapena osasun, hezkuntza eta enplegu zerbitzu berriekin, milaka erabiltzaileetara helduz.",
    history_2025_title: "Atari Digital Berritua",
    history_2025_description: "Plataforma digital berriaren abioa hizkuntza anitzeko interfazearekin eta zerbitzu digital aurreratuak.",
    our_team: "Gure Taldea",
    team_director: "Zuzendari Nagusia",
    team_coordinator: "Zerbitzuen Koordinatzailea",
    team_social_worker: "Gizarte Langilea",
    team_translator: "Itzultzaile eta Interpretea",
    ana_description: "Migrazio politiketan aditua 15 urte baino gehiagoko esperientziarekin.",
    mohamed_description: "Koordinatzaile elebiduna errefuxiatu eta asylo eskatzaileen arretako adituak.",
    elena_description: "Gizarte langilea familia eta komunitatearen esku-hartze adituak.",
    amir_description: "Arabera, frantsesa eta gaztelaniako itzultzaile ziurtagiria kultura bitartekotasun esperientziarekin.",
    our_partners: "Gure Kideak",
    government_euskadi: "Eusko Jaurlaritza",
    civil_organizations: "Erakunde Zibilak",
    international_orgs: "Nazioarteko Erakundeak",
    partner_government_description: "Euskal erakundeekin lankidetza estua zerbitzu publiko eskuragarriak bermatzeko.",
    partner_civil_description: "GKEen eta tokiko elkarteen sarea migratzaileen komunitateekin zuzenean lan egiten dutenak.",
    partner_international_description: "ACNUR, OIM eta beste nazioarteko erakundeekin lankidetza.",
    join_us_title: "Bat Egin Gure Misioarekin",
    join_us_description: "Elkarrekin gizarte inklusibo eta solidario bat eraiki dezakegu. Zure parte-hartzea funtsezkoa da.",
    contact_us: "Jarri Gurekin Harremanetan",
    explore_services: "Zerbitzuak Arakatu",
    // Ads page
    ads_title: "Komunitateko Iragarkiak",
    ads_subtitle: "Euskadiko migratzaileen komunitatearentzat iragarki erabilgarriak aurkitu eta argitaratu",
    filter_ads: "Iragarkiak Iragazi",
    category: "Kategoria",
    location: "Kokapena",
    urgent_only: "Larrizkoak soilik",
    add_ad: "Iragarkia Argitaratu",
    showing_results: "Erakusten",
    of: "tik",
    ads: "iragarki",
    all_categories: "Kategoria guztiak",
    all_locations: "Kokapen guztiak",
    community: "Komunitatea",
    search_placeholder: "Bilatu iragarkiak...",
    urgent: "Larria",
    verified: "Egiaztatua",
    price: "Prezioa",
    date: "Data",
    contact: "Harremana",
    no_ads_found: "Ez da iragarkrik aurkitu",
    try_different_filters: "Saiatu iragazki ezberdinak erabiliz",
    clear_filters: "Iragazkiak garbitu",
    share_your_ad: "Partekatu Zure Iragarkia",
    help_community_description: "Lagundu komunitateari informazio erabilgarria, zerbitzuak edo aukerak partekatuz",
    publish_ad: "Iragarkia Argitaratu",
    need_help: "Laguntza behar duzu?",
    negotiable: "Negoziagailea",
    free_consultation: "Kontsulta dohainekoa",
    free: "Dohainik",
    // Sample ads
    ad_housing_vitoria: "Gela eskuragarri Gasteizen",
    ad_housing_vitoria_desc: "Gela altzariduna pisu partekatuan, erdialdearen zonaldean, garraio publikoa gertu.",
    ad_job_bilbao: "Zerbitzariaren lana Bilbon",
    ad_job_bilbao_desc: "Jatetxeak esperientzia duen zerbitzaria behar du, ordu malgua, lan ingurune ona.",
    ad_spanish_classes: "Gaztelaniako klase pertsonalizatuak",
    ad_spanish_classes_desc: "Irakasle jatorrak migratzaileentzat gaztelaniako klaseak eskaintzen ditu, maila guztiak.",
    ad_legal_services: "Migratzaileentzako aholkularitza legala",
    ad_legal_services_desc: "Atzerritar legean aditua den abokatu, lehen kontsulta dohainik.",
    ad_medical_interpreter: "Arabera-gaztelania mediku interpretea",
    ad_medical_interpreter_desc: "Mediku hizketa eta osasun tramiteentzako interpretazio zerbitzua.",
    ad_community_event: "Komunitate gertaera kultura arteko",
    ad_community_event_desc: "Kultura anitzeko ospakizuna janaria, musika eta familia osorako jarduerak.",
  },
};

function detectInitial(): Locale {
  try {
    const saved = localStorage.getItem(LS_KEY) as Locale | null;
    if (saved && LOCALES.includes(saved)) return saved;
  } catch {}
  const nav = (navigator.language || navigator.languages?.[0] || "").toLowerCase();
  if (nav.startsWith("eu")) return "eu";
  if (nav.startsWith("es")) return "es";
  if (nav.startsWith("en")) return "en";
  if (nav.startsWith("ar")) return "ar";
  return "eu";
}

export function I18nProvider({ children }: { children: React.ReactNode }) {
  const [locale, setLocaleState] = useState<Locale>(() => detectInitial());

  useEffect(() => {
    try { localStorage.setItem(LS_KEY, locale); } catch {}
    const html = document.documentElement;
    html.lang = locale;
    html.dir = RTL[locale] ? "rtl" : "ltr";
  }, [locale]);

  const t = useMemo(() => {
    const dict = dicts[locale] ?? {};
    return (key: string) => dict[key] ?? key;
  }, [locale]);

  const setLocale = (l: Locale) => { if (LOCALES.includes(l)) setLocaleState(l); };

  return (
    <I18nContext.Provider value={{ locale, t, setLocale, locales: LOCALES }}>
      {children}
    </I18nContext.Provider>
  );
}

export function useI18n() {
  const ctx = useContext(I18nContext);
  if (!ctx) throw new Error("useI18n must be used within <I18nProvider>");
  return ctx;
}
